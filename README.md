# Задание
Описание задания
Необходимо проработать взаимодействие с провайдером – онлайн кинотеатром через АПИ

Условия:
1. В АПИ провайдера есть следующие методы:
- Поиск фильма по названию – может вернуть множество значений
- Получение информации о фильме и ссылки на просмотр по id фильма
2. Последовательность вызова следующая:
- Система А посылает запрос к одному из методов в систему В через kafka
- Система B получает запрос, осуществляет вызов метода апи провайдера по rest-у
- Система B получает ответ от провайдера, формирует ответное сообщение и отправляет в систему А через kafka

Что нужно сделать:
1. Продумать атрибутный состав rest сервисов провайдера
2. Описать спецификацию сервисов провайдера в формате json
3. Описать форматы сообщений между системами А и B
4. Нарисовать sequence диаграмму сценария поиска процесса фильма системой А и получения информации по фильму

# Решение
1. Спецификация описана в формате OpenAPI в приложенном файле [swagger-provider.yaml](https://github.com/tanyanec/sbdtt/blob/main/swagger-provider.yaml) и включает в себя атрибутный состав REST-сервисов (п. 1 задачи).
3. Спецификация сообщений:
- Для получения информации о фильме используется топик `get_film_info`

  Формат запроса из Системы А
  ```json
  {
    "request_id": "123e4567-e89b-12d3-a456-426655440000",
    "id": "123e4567-e89b-12d3-a456-426655440000"
  }
  ```
  
  Формат ответа из Системы В
  ```json
  {
    "request_id": "123e4567-e89b-12d3-a456-426655440000",
    "film_info":
      {
        "film_id": "123e4567-e89b-12d3-a456-426655449999",
        "title": "Джентельмены",
        "description": "Успешное возвращение Гая Ричи к корням — острая и живая криминальная комедия с блестящим актерским составом",
        "issue_year": 2019,
        "genre": [
          "Боевик"
        ],
        "producer": "Гай Ричи",
        "lasting": 113,
        "link": "string",
        "rating": 8.5,
        "trailer": "string",
        "country": "Великобритания",
        "actors": [
          "Мэттью МакКонахи"
        ],
        "age_limit": 5
      }
  }
  ```
  
 
- Для поиска фильма по названию используется топик `search_film`

  Формат запроса из Системы А
  ```json
  {
    "request_id": "123e4567-e89b-12d3-a456-426655440000",
    "title": "Джентельмены"
  }
  ```
  
  Формат ответа из Системы В
   ```json
  {
    "request_id": "123e4567-e89b-12d3-a456-426655440000",
    "films": [
        {
          "id": "123e4567-e89b-12d3-a456-426655449999",
          "title": "Джентельмены"
        }
      ]
  }
  ```
  
 
4. Далее представлены sequence-диаграммы процессов:
- Сценария поиска процесса фильма системой А
    ![Поиск фильма](http://www.plantuml.com/plantuml/proxy?cache=no&src=https://raw.githubusercontent.com/tanyanec/sbdtt/main/film-search.iuml)
    
    
- Сценария получения информации о фильме
    ![Получение информации о фильме](http://www.plantuml.com/plantuml/proxy?cache=no&src=https://raw.githubusercontent.com/tanyanec/sbdtt/main/get-film.iuml)

# Комментарии
Взаимодействие Системы А и Сисиемы В асинхронное через Kafka. 
Взаимодействие Системы В и Провайдера синхронное по http.

Комментарий к сиквенсу:
Не стала описывать alt на схеме, чтобы она проще читалась. Альтернативные сценарии с ошибками можно описать в рамках UC по взаимодействию систем. Возможно учесть, что при недоступности какого-либо сервиса можно сделать повтор запроса через N времени. При получении ответа об отсутствии фильма - возврат клиентской ошибки.

Комментарий к Swagger:
В зависимости от требований к системе можно описать атрибут Актер отдельной схемой (id+name). Это может быть полезно, если в будущем будет реализован поиск фильмов по актерам.

В тексте задания не было ничего сказано про ролевую систему. Можно добавить авторизацию в провайдере по токену или по логину/паролю.
